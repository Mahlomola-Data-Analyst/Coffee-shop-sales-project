SELECT COUNT(DISTINCT TRANSACTION_ID) AS NUMBER_OF_SALES,
SUM(TRANSACTION_QTY) AS NUMBER_OF_UNITS_SOLD,
SUM(TRANSACTION_QTY*TO_NUMBER(REPLACE(UNIT_PRICE,',','.'))) AS TOTAL_REVENUE,
TO_DATE(TRANSACTION_DATE)AS PURCHASE_DATE,
TO_CHAR(TO_DATE(TRANSACTION_DATE),'mon')AS MONTH_ID,
DAYNAME(TO_DATE(TRANSACTION_DATE)) AS DAY_OF_WEEK,
CASE
    WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'MORNING'
    WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '16:59:59' THEN 'AFTERNOON'
    WHEN TRANSACTION_TIME BETWEEN '17:00:00' AND '20:59:59' THEN 'EVENING'
    ELSE 'NIGHT'
    END AS TIME_BUCKETS,
STORE_LOCATION,
PRODUCT_CATEGORY,
PRODUCT_DETAIL,
PRODUCT_TYPE
FROM COFFEE_SHOP_SALES.PUBLIC.COFFEE_SHOP_SALES
GROUP BY
PURCHASE_DATE,
STORE_LOCATION,
PRODUCT_CATEGORY,
PRODUCT_DETAIL,
PRODUCT_TYPE,
MONTH_NAME,
DAY_OF_WEEK,
TIME_BUCKETS